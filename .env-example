# ============================================
# Application Configuration
# ============================================

# Application Environment
# Options: development, production, test
NODE_ENV=development

# Server Configuration
PORT=8085
HOST=0.0.0.0

# ============================================
# Database Configuration
# ============================================

# PostgreSQL Database URL
# Format: postgresql://user:password@host:port/database
DATABASE_URL=postgresql://user:password@localhost:5432/arcanedb

# Database SSL Configuration
# Set to 'true' to enable SSL (e.g., for cloud databases)
DATABASE_SSL=false

# ============================================
# Better Auth Configuration
# ============================================

# Better Auth Secret (REQUIRED - Use a strong, random secret in production)
# Used to encrypt tokens and email verification hashes
# Generate with: openssl rand -base64 32
BETTER_AUTH_SECRET=your-better-auth-secret-change-in-production

# Better Auth Base URL (REQUIRED)
# The base URL for your Better Auth server
# For development: http://localhost:8085
# For production: https://your-domain.com
# This is critical for OAuth callback URLs
BETTER_AUTH_URL=http://localhost:8085

# Frontend URL (Optional - defaults to http://localhost:3000)
# Comma-separated list of trusted frontend origins for CORS
# Example: http://localhost:3000,https://app.example.com
FRONTEND_URL=http://localhost:3000

# ============================================
# Okta SAML SSO Configuration (Optional)
# ============================================
# Set OKTA_SSO_ENABLED=true to enable Okta SSO. When false or unset, Okta is disabled.
# The login page shows SSO when enabled; no frontend configuration needed.
# Run `npx @better-auth/cli migrate` with OKTA_SSO_ENABLED=true to create SSO tables.
OKTA_SSO_ENABLED=false
# OKTA_SSO_ENTRY_POINT=https://your-org.okta.com/app/xxx/sso/saml
# OKTA_ENTITY_ID=https://your-org.okta.com/app/xxx/sso/saml/metadata
# OKTA_SAML_CERT=-----BEGIN CERTIFICATE-----\n...\n-----END CERTIFICATE-----
# OKTA_SSO_CALLBACK_URL=/organisations
# OKTA_ISSUER_URL=https://your-org.okta.com
# BETTER_AUTH_SSO_DOMAIN=localhost:3000

# ============================================
# JWT Authentication Configuration (Legacy - may not be used with Better Auth)
# ============================================

# JWT Secret Key (REQUIRED - Use a strong, random secret in production)
# Generate with: openssl rand -base64 32
JWT_SECRET=your-secret-key-change-in-production

# JWT Token Expiration
# Format: number followed by unit (s=seconds, m=minutes, h=hours, d=days)
# Examples: '15m', '1h', '7d', '24h'
JWT_EXPIRES_IN=24h
JWT_ACCESS_TOKEN_EXPIRY=15m
JWT_REFRESH_TOKEN_EXPIRY=7d

# ============================================
# Cookie Configuration
# ============================================

# Cookie Security Settings
# Set to 'true' in production with HTTPS
COOKIE_SECURE=false
COOKIE_SAME_SITE=lax
COOKIE_PATH=/
# Optional: Set cookie domain for cross-subdomain support
# Example: .example.com or example.com
COOKIE_DOMAIN=


# ============================================
# Password Hashing Configuration
# ============================================

# Bcrypt Rounds (higher = more secure but slower)
# Recommended: 10-12
BCRYPT_ROUNDS=10

# ============================================
# Cache Configuration
# ============================================

# Cache TTL in milliseconds (default: 1 hour = 3600000)
CACHE_TTL_MS=3600000

# Maximum number of items in cache
CACHE_MAX_ITEMS=100

# ============================================
# Application Startup Configuration
# ============================================

# Application startup delay in milliseconds
# Time to wait before marking application as ready (default: 5000ms = 5 seconds)
APP_STARTUP_DELAY_MS=5000

# ============================================
# Dataset Configuration
# ============================================

# Maximum file size for dataset uploads in MB (default: 10MB)
DATASET_MAX_FILE_SIZE_MB=10

# ============================================
# Email Configuration
# ============================================

# SMTP Host (REQUIRED for email sending)
# Example: smtp.gmail.com, smtp.ethereal.email
SMTP_HOST=

# SMTP Port (default: 587)
SMTP_PORT=587

# SMTP Secure (use TLS/SSL)
# Set to 'true' for port 465, 'false' for port 587
SMTP_SECURE=false

# SMTP Authentication
SMTP_USER=
SMTP_PASS=

# Email From Address
# Example: no-reply@example.com
MAIL_FROM=no-reply@example.com

# ============================================
# Project API Keys (Public API)
# ============================================
# Salt for hashing project-scoped API keys (REQUIRED for public API)
# Generate with: openssl rand -hex 32
API_KEY_SALT=

# ============================================
# Model Configuration Encryption
# ============================================
# Encrypts API keys and credentials in model configurations at rest
# Generate with: openssl rand -hex 32
ENCRYPTION_KEY=

# ============================================
# Message Broker Configuration
# ============================================
# Broker type: rabbitmq (default) or kafka
# Both NestJS and Python worker must use the same broker
MESSAGE_BROKER=rabbitmq

# RabbitMQ (when MESSAGE_BROKER=rabbitmq)
RABBITMQ_URL=amqp://guest:guest@localhost:5672/
# Or use individual vars:
# RABBITMQ_HOST=localhost
# RABBITMQ_PORT=5672
# RABBITMQ_USERNAME=guest
# RABBITMQ_PASSWORD=guest
# RABBITMQ_VHOST=/

# Topic/queue names (broker-agnostic; used by both Kafka and RabbitMQ)
# Must match arcane-worker config
# EVALUATION_JOBS_TOPIC=evaluation-jobs
# EVALUATION_RESULTS_TOPIC=evaluation-results
# EXPERIMENT_JOBS_TOPIC=experiment-jobs
# EXPERIMENT_RESULTS_TOPIC=experiment-results

# Kafka (when MESSAGE_BROKER=kafka)
# KAFKA_BROKERS=localhost:9092
# KAFKA_CLIENT_ID=arcane
# KAFKA_SSL_ENABLED=false
# KAFKA_SASL_ENABLED=false
# KAFKA_SASL_MECHANISM=plain
# KAFKA_SASL_USERNAME=
# KAFKA_SASL_PASSWORD=

# ============================================
# Data Retention Configuration
# ============================================

# Retention Job Cron Schedule (Optional)
# Cron expression for when retention jobs should run
# Default: '0 2 * * *' (daily at 2 AM)
# Examples:
#   '0 2 * * *'     - Daily at 2 AM (default)
#   '0 3 * * 0'     - Weekly on Sunday at 3 AM
#   '0 */6 * * *'   - Every 6 hours
#   '0 0 1 * *'     - Monthly on the 1st at midnight
# Format: minute hour day month day-of-week
RETENTION_JOB_CRON=0 2 * * *

